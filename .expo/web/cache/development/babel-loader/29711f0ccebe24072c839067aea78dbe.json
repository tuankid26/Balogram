{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\VietAnh\\\\Balogram\\\\screen\\\\MediaPicker.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport { Button, Text, Image, Icon } from 'react-native-elements';\nimport { useDispatch } from 'react-redux';\nimport { mediaActions } from \"../redux/actions\";\nimport { ImageHelper } from \"../helpers\";\nimport { useSelector } from 'react-redux';\nimport { Picker } from '@react-native-picker/picker';\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\n\nvar _Dimensions$get = Dimensions.get('window'),\n    width = _Dimensions$get.width;\n\nvar Header = function Header(props) {\n  var Item = Picker.Item;\n  return React.createElement(View, {\n    style: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      marginBottom: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18,\n      columnNumber: 5\n    }\n  }, React.createElement(Icon, {\n    name: \"close\",\n    type: \"antdesign\",\n    iconStyle: {\n      marginLeft: 10\n    },\n    onPress: props.handleBack,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: {\n      width: 200\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }\n  }, React.createElement(Picker, {\n    mode: \"dropdown\",\n    selectedValue: props.selectedAlbum,\n    onValueChange: props.handleAlbumSelected,\n    style: {\n      marginRight: 40\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 9\n    }\n  }, props.albumNames.map(function (album, idx) {\n    return React.createElement(Item, {\n      key: idx,\n      label: album,\n      value: album,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 17\n      }\n    });\n  }))), props.selectedAssets.length > 0 ? React.createElement(Button, {\n    title: \"Next\",\n    containerStyle: {\n      marginRight: 20\n    },\n    style: {\n      marginRight: 20\n    },\n    onPress: props.handleSend,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 11\n    }\n  }) : React.createElement(Icon, {\n    type: \"antdesign\",\n    name: \"camera\",\n    size: 28,\n    iconStyle: {\n      marginRight: 20\n    },\n    onPress: props.handleLaunchCamera,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 11\n    }\n  }));\n};\n\nvar MediaItem = function MediaItem(props) {\n  var selectedAssets = props.selectedAssets;\n  var item = props.item;\n\n  var isInSelectedAssets = function isInSelectedAssets() {\n    return selectedAssets.filter(function (asset) {\n      return asset.uri === item.uri;\n    }).length > 0;\n  };\n\n  var getIndexInSelectedAssets = function getIndexInSelectedAssets() {\n    return selectedAssets.findIndex(function (asset) {\n      return asset.uri === item.uri;\n    });\n  };\n\n  return React.createElement(TouchableOpacity, {\n    style: {\n      position: 'relative'\n    },\n    onPress: function onPress() {\n      return props.handleItemSelected(item);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  }, React.createElement(Image, {\n    source: {\n      uri: item.uri\n    },\n    style: styles.image,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: [styles.selectedImage, {\n      backgroundColor: isInSelectedAssets() ? 'rgba(255,255,255,0.40);' : 'transparent'\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: [styles.selected, {\n      backgroundColor: isInSelectedAssets() ? '#0275d8' : '#292b2c',\n      borderColor: 'white',\n      borderWidth: 2\n    }],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.text,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 9\n    }\n  }, isInSelectedAssets() ? getIndexInSelectedAssets() + 1 : '')));\n};\n\nvar Content = function Content(props) {\n  return React.createElement(FlatList, {\n    columnWrapperStyle: {\n      flexWrap: 'wrap',\n      width: '100%'\n    },\n    data: props.albumAssets,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(MediaItem, {\n        item: item,\n        selectedAssets: props.selectedAssets,\n        handleItemSelected: props.handleItemSelected,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 9\n        }\n      });\n    },\n    keyExtractor: function keyExtractor(item) {\n      return item.id;\n    },\n    numColumns: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  });\n};\n\nvar MediaPicker = function MediaPicker(_ref2) {\n  var navigation = _ref2.navigation;\n  var albumNames = ['Camera', 'Screenshots', 'Messenger', 'Zalo', 'Facebook'];\n  var dispatch = useDispatch();\n\n  var _useState = useState(albumNames[0]),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedAlbum = _useState2[0],\n      setSelectedAlbum = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      albumAssets = _useState4[0],\n      setAlbumAssets = _useState4[1];\n\n  var selectedAssets = useSelector(function (state) {\n    return state.media.selectedAssets;\n  });\n  useEffect(function () {\n    var fetchAlbumAssets = function fetchAlbumAssets(albumName) {\n      var albumAssets;\n      return _regeneratorRuntime.async(function fetchAlbumAssets$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(fetchAllAssetsInAlbum(albumName));\n\n            case 2:\n              albumAssets = _context.sent;\n              setAlbumAssets(albumAssets);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    fetchAlbumAssets(selectedAlbum);\n  }, [selectedAlbum]);\n\n  var fetchAllAssetsInAlbum = function fetchAllAssetsInAlbum(albumName) {\n    var albumAssets, album;\n    return _regeneratorRuntime.async(function fetchAllAssetsInAlbum$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            albumAssets = [];\n            _context2.prev = 1;\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(ImageHelper.getAlbum(albumName));\n\n          case 4:\n            album = _context2.sent;\n            _context2.next = 7;\n            return _regeneratorRuntime.awrap(ImageHelper.getAssetsInAlbum(album));\n\n          case 7:\n            albumAssets = _context2.sent;\n            _context2.next = 13;\n            break;\n\n          case 10:\n            _context2.prev = 10;\n            _context2.t0 = _context2[\"catch\"](1);\n            console.log(_context2.t0);\n\n          case 13:\n            return _context2.abrupt(\"return\", albumAssets.assets);\n\n          case 14:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[1, 10]], Promise);\n  };\n\n  var handleBack = function handleBack() {\n    dispatch(mediaActions.resetState());\n    navigation.goBack();\n  };\n\n  var handleAlbumSelected = function handleAlbumSelected(album) {\n    return setSelectedAlbum(album);\n  };\n\n  var handleItemSelected = function handleItemSelected(item) {\n    var result;\n    return _regeneratorRuntime.async(function handleItemSelected$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(ImageHelper.resizeImage(item));\n\n          case 2:\n            result = _context3.sent;\n            item.uri = result.uri;\n            console.log(item);\n\n            if (selectedAssets.indexOf(item) >= 0) {\n              dispatch(mediaActions.removeAsset(item));\n            } else {\n              dispatch(mediaActions.addAsset(item));\n            }\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleSend = function handleSend() {\n    navigation.goBack();\n  };\n\n  var handleLaunchCamera = function handleLaunchCamera() {\n    var result;\n    return _regeneratorRuntime.async(function handleLaunchCamera$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(ImageHelper.launchCamera());\n\n          case 2:\n            result = _context4.sent;\n\n          case 3:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 5\n    }\n  }, React.createElement(Header, {\n    albumNames: albumNames,\n    selectedAssets: selectedAssets,\n    selectedAlbum: selectedAlbum,\n    handleBack: handleBack,\n    handleSend: handleSend,\n    handleAlbumSelected: handleAlbumSelected,\n    handleLaunchCamera: handleLaunchCamera,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }\n  }), React.createElement(Content, {\n    albumAssets: albumAssets,\n    selectedAssets: selectedAssets,\n    handleItemSelected: handleItemSelected,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }\n  }));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    marginTop: StatusBar.currentHeight + 10\n  },\n  image: {\n    width: width / 3,\n    height: width / 3,\n    resizeMode: 'cover'\n  },\n  selectedImage: {\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    top: 0,\n    left: 0\n  },\n  text: {\n    fontSize: 13,\n    color: '#FFFFFF'\n  },\n  selected: {\n    position: 'absolute',\n    top: 2,\n    right: 10,\n    width: 22,\n    height: 22,\n    borderRadius: 15,\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});\nMediaPicker.propTypes = {};\nexport default MediaPicker;","map":{"version":3,"sources":["C:/Users/VietAnh/Balogram/screen/MediaPicker.js"],"names":["React","useEffect","useState","PropTypes","Button","Text","Image","Icon","useDispatch","mediaActions","ImageHelper","useSelector","Picker","Dimensions","get","width","Header","props","Item","flexDirection","justifyContent","marginBottom","marginLeft","handleBack","selectedAlbum","handleAlbumSelected","marginRight","albumNames","map","album","idx","selectedAssets","length","handleSend","handleLaunchCamera","MediaItem","item","isInSelectedAssets","filter","asset","uri","getIndexInSelectedAssets","findIndex","position","handleItemSelected","styles","image","selectedImage","backgroundColor","selected","borderColor","borderWidth","text","Content","flexWrap","albumAssets","id","MediaPicker","navigation","dispatch","setSelectedAlbum","setAlbumAssets","state","media","fetchAlbumAssets","albumName","fetchAllAssetsInAlbum","getAlbum","getAssetsInAlbum","console","log","assets","resetState","goBack","resizeImage","result","indexOf","removeAsset","addAsset","launchCamera","container","StyleSheet","create","marginTop","StatusBar","currentHeight","height","resizeMode","top","left","fontSize","color","right","borderRadius","alignItems","propTypes"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { FlatList, StyleSheet, TouchableOpacity, View, Dimensions } from 'react-native';\r\nimport { Button, Text, Image, Icon } from 'react-native-elements';\r\nimport { useDispatch } from 'react-redux';\r\nimport { mediaActions } from '../redux/actions';\r\nimport { ImageHelper } from '../helpers';\r\nimport { useSelector } from 'react-redux';\r\nimport { Picker } from '@react-native-picker/picker';\r\nimport { StatusBar } from 'react-native';\r\nconst { width } = Dimensions.get('window')\r\n\r\nconst Header = props => {\r\n\r\n  const Item = Picker.Item;\r\n\r\n  return (\r\n    <View style={{ flexDirection: 'row', justifyContent: 'space-between', marginBottom: 10 }}>\r\n      <Icon\r\n        name='close'\r\n        type='antdesign'\r\n\r\n        iconStyle={{\r\n          marginLeft: 10,\r\n        }}\r\n        onPress={props.handleBack}\r\n      />\r\n\r\n      <View style={{ width: 200 }}>\r\n        <Picker\r\n          mode='dropdown'\r\n          selectedValue={props.selectedAlbum}\r\n          onValueChange={props.handleAlbumSelected}\r\n          style={{ marginRight: 40 }}>\r\n          {\r\n            props.albumNames.map((album, idx) => {\r\n              return (\r\n                <Item key={idx} label={album} value={album} />\r\n              );\r\n            })\r\n          }\r\n        </Picker>\r\n      </View>\r\n\r\n      {\r\n        props.selectedAssets.length > 0 ?\r\n          <Button\r\n            title='Next'\r\n            containerStyle={{ marginRight: 20 }}\r\n            style={{ marginRight: 20 }}\r\n            onPress={props.handleSend}\r\n          />\r\n          :\r\n          <Icon\r\n            type='antdesign'\r\n            name='camera'\r\n            size={28}\r\n            iconStyle={{ marginRight: 20 }}\r\n            onPress={props.handleLaunchCamera}\r\n          />\r\n      }\r\n    </View>\r\n  );\r\n};\r\n\r\nconst MediaItem = props => {\r\n  const selectedAssets = props.selectedAssets;\r\n  const item = props.item;\r\n\r\n  const isInSelectedAssets = () => {\r\n    return selectedAssets.filter(asset => asset.uri === item.uri).length > 0;\r\n  }\r\n\r\n  const getIndexInSelectedAssets = () => {\r\n    return selectedAssets.findIndex(asset => asset.uri === item.uri);\r\n  }\r\n\r\n  return (\r\n\r\n    <TouchableOpacity\r\n      style={{ position: 'relative' }}\r\n      onPress={() => props.handleItemSelected(item)}\r\n    >\r\n      <Image\r\n        source={{\r\n          uri: item.uri,\r\n        }}\r\n        style={styles.image}\r\n      />\r\n\r\n      <View\r\n        style={[\r\n          styles.selectedImage,\r\n          {\r\n            backgroundColor: isInSelectedAssets()\r\n              ? 'rgba(255,255,255,0.40);'\r\n              : 'transparent',\r\n          },\r\n        ]}\r\n      />\r\n\r\n      <View\r\n        style={[\r\n          styles.selected,\r\n          {\r\n            backgroundColor:\r\n              isInSelectedAssets()\r\n                ? '#0275d8'\r\n                : '#292b2c',\r\n            borderColor: 'white',\r\n            borderWidth: 2,\r\n          },\r\n        ]}\r\n      >\r\n        <Text style={styles.text}>\r\n          {isInSelectedAssets()\r\n            ? getIndexInSelectedAssets() + 1\r\n            : ''}\r\n        </Text>\r\n      </View>\r\n\r\n    </TouchableOpacity>\r\n\r\n  )\r\n};\r\n\r\nconst Content = props => {\r\n\r\n  return (\r\n    <FlatList\r\n      columnWrapperStyle={{\r\n        flexWrap: 'wrap',\r\n        width: '100%',\r\n      }}\r\n      data={props.albumAssets}\r\n      renderItem={({ item }) =>\r\n        <MediaItem\r\n          item={item}\r\n          selectedAssets={props.selectedAssets}\r\n          handleItemSelected={props.handleItemSelected}\r\n        />\r\n      }\r\n      keyExtractor={(item) => item.id}\r\n      numColumns={3}\r\n    />\r\n  )\r\n};\r\n\r\nconst MediaPicker = ({ navigation }) => {\r\n  const albumNames = ['Camera', 'Screenshots', 'Messenger', 'Zalo', 'Facebook'];\r\n  const dispatch = useDispatch();\r\n  const [selectedAlbum, setSelectedAlbum] = useState(albumNames[0]);\r\n  const [albumAssets, setAlbumAssets] = useState([]);\r\n\r\n  const selectedAssets = useSelector(state => state.media.selectedAssets);\r\n\r\n  useEffect(() => {\r\n    const fetchAlbumAssets = async (albumName) => {\r\n      const albumAssets = await fetchAllAssetsInAlbum(albumName);\r\n      setAlbumAssets(albumAssets);\r\n    }\r\n    fetchAlbumAssets(selectedAlbum);\r\n  }, [selectedAlbum]);\r\n\r\n  const fetchAllAssetsInAlbum = async (albumName) => {\r\n\r\n    let albumAssets = [];\r\n\r\n    try {\r\n      const album = await ImageHelper.getAlbum(albumName);\r\n      albumAssets = await ImageHelper.getAssetsInAlbum(album);\r\n\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n    return albumAssets.assets;\r\n  }\r\n\r\n\r\n  const handleBack = () => {\r\n    // const listItem = useSelector();\r\n    // console.log(listItem);\r\n    dispatch(mediaActions.resetState());\r\n    navigation.goBack();\r\n  }\r\n\r\n  const handleAlbumSelected = (album) => setSelectedAlbum(album);\r\n\r\n  const handleItemSelected = async (item) => {\r\n    const result = await ImageHelper.resizeImage(item);\r\n    item.uri = result.uri;\r\n    console.log(item);\r\n    if (selectedAssets.indexOf(item) >= 0) {\r\n      dispatch(mediaActions.removeAsset(item))\r\n    } else {\r\n      dispatch(mediaActions.addAsset(item));\r\n    }\r\n  };\r\n\r\n  const handleSend = () => {\r\n    navigation.goBack();\r\n  }\r\n\r\n\r\n  const handleLaunchCamera = async () => {\r\n    const result = await ImageHelper.launchCamera();\r\n    // console.log(result)\r\n\r\n    // if (!result.cancelled) {\r\n    //   console.log(result.uri);\r\n    // }\r\n  }\r\n\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Header\r\n        albumNames={albumNames}\r\n        selectedAssets={selectedAssets}\r\n        selectedAlbum={selectedAlbum}\r\n        handleBack={handleBack}\r\n        handleSend={handleSend}\r\n        handleAlbumSelected={handleAlbumSelected}\r\n        handleLaunchCamera={handleLaunchCamera}\r\n      />\r\n\r\n      <Content\r\n        albumAssets={albumAssets}\r\n        selectedAssets={selectedAssets}\r\n        handleItemSelected={handleItemSelected}\r\n      />\r\n    </View>\r\n\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    marginTop: StatusBar.currentHeight + 10,\r\n  },\r\n  image: {\r\n    width: width / 3,\r\n    height: width / 3,\r\n    resizeMode: 'cover',\r\n    // marginRight: 2,\r\n  },\r\n  selectedImage: {\r\n    position: 'absolute',\r\n    width: '100%',\r\n    height: '100%',\r\n    top: 0,\r\n    left: 0,\r\n  },\r\n  text: {\r\n    fontSize: 13,\r\n    color: '#FFFFFF'\r\n  },\r\n  selected: {\r\n    position: 'absolute',\r\n    top: 2,\r\n    right: 10,\r\n    width: 22,\r\n    height: 22,\r\n    borderRadius: 15,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  }\r\n});\r\n\r\n\r\nMediaPicker.propTypes = {\r\n\r\n};\r\n\r\nexport default MediaPicker;"]},"metadata":{},"sourceType":"module"}